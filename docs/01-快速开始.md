# 01. å¿«é€Ÿå¼€å§‹

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨ 5 åˆ†é’Ÿå†…è¿è¡Œç¬¬ä¸€ä¸ª DiT æ–‡ç”Ÿå›¾ç¤ºä¾‹ã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

- **GPU**: NVIDIA GPUï¼ˆæ¨è RTX 4090ï¼Œ24GB æ˜¾å­˜ï¼‰
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆæ¨è 3.10ï¼‰
- **CUDA**: 11.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å­˜å‚¨**: è‡³å°‘ 50GB å¯ç”¨ç©ºé—´

## ğŸš€ 5 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
conda create -n dit python=3.10
conda activate dit

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### æ­¥éª¤ 2: å‡†å¤‡æ•°æ®

é¡¹ç›®æ”¯æŒä¸‰ç§æ•°æ®é›†ï¼šCOCOã€CUB å’Œè‡ªå®šä¹‰æ•°æ®é›†ã€‚è¿™é‡Œä»¥ COCO ä¸ºä¾‹ï¼š

```bash
# å‡†å¤‡ COCO æ•°æ®é›†ï¼ˆ5000 ä¸ªæ ·æœ¬ï¼‰
python src/scripts/prepare_data.py \
    --type coco \
    --output ./data/coco_subset \
    --num_samples 5000
```

**æ³¨æ„**: å¦‚æœç½‘ç»œè¾ƒæ…¢ï¼Œå¯ä»¥ï¼š
- ä½¿ç”¨ä»£ç†ï¼š`export HTTP_PROXY=http://127.0.0.1:7890`
- ä½¿ç”¨é•œåƒï¼š`export HF_ENDPOINT=https://hf-mirror.com`

### æ­¥éª¤ 3: é…ç½®è®­ç»ƒå‚æ•°

ç¼–è¾‘ `configs/train_config.yaml`ï¼Œç¡®ä¿æ•°æ®é…ç½®æ­£ç¡®ï¼š

```yaml
data:
  dataset_name: "coco"  # æˆ– "cub", "custom"
  dataset_path: "./data/coco_subset"
  num_samples: 5000
  image_size: 256
```

### æ­¥éª¤ 4: å¼€å§‹è®­ç»ƒ

```bash
# åŸºç¡€è®­ç»ƒå‘½ä»¤
python src/scripts/train.py --config configs/train_config.yaml
```

**è®­ç»ƒå‚æ•°è¯´æ˜**ï¼š
- `--config`: é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `configs/train_config.yaml`ï¼‰
- `--resume`: æ¢å¤è®­ç»ƒçš„æ£€æŸ¥ç‚¹è·¯å¾„ï¼ˆå¯é€‰ï¼‰

**è®­ç»ƒè¾“å‡º**ï¼š
- æ¨¡å‹æ£€æŸ¥ç‚¹ä¿å­˜åœ¨ `./outputs/checkpoint-epoch-{epoch}/`
- æ—¥å¿—ä¿å­˜åœ¨ `./outputs/train.log`
- æ¯ 10 ä¸ª epoch è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡ï¼ˆå¯åœ¨é…ç½®ä¸­ä¿®æ”¹ `save_every_n_epochs`ï¼‰

### æ­¥éª¤ 5: ç”Ÿæˆå›¾åƒ

è®­ç»ƒå®Œæˆåï¼ˆæˆ–ä½¿ç”¨ä¸­é—´æ£€æŸ¥ç‚¹ï¼‰ï¼Œç”Ÿæˆå›¾åƒï¼š

```bash
python src/scripts/inference.py \
    --checkpoint ./outputs/checkpoint-epoch-10 \
    --prompt "a cat sitting on a chair" \
    --output ./outputs/generated
```

**æ¨ç†å‚æ•°è¯´æ˜**ï¼š
- `--checkpoint`: æ¨¡å‹æ£€æŸ¥ç‚¹è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--prompt`: æ–‡æœ¬æç¤ºï¼ˆå¿…éœ€ï¼‰
- `--output`: è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤: `./outputs/generated`ï¼‰
- `--num_inference_steps`: æ¨ç†æ­¥æ•°ï¼ˆé»˜è®¤: 50ï¼‰
- `--height`, `--width`: å›¾åƒå°ºå¯¸ï¼ˆé»˜è®¤: 256ï¼‰
- `--seed`: éšæœºç§å­ï¼ˆå¯é€‰ï¼‰

## ğŸ“Š å®Œæ•´ç¤ºä¾‹

### ä½¿ç”¨ CUB æ•°æ®é›†

```bash
# 1. å‡†å¤‡ CUB æ•°æ®ï¼ˆå¦‚æœå·²ä» Kaggle ä¸‹è½½ï¼‰
python src/scripts/prepare_cub_from_kaggle.py \
    --kaggle_dir ./data/cub_raw/cub2002011 \
    --output ./data/cub_subset \
    --num_samples 5000

# 2. ä¿®æ”¹é…ç½®
# ç¼–è¾‘ configs/train_config.yaml:
#   dataset_name: "cub"
#   dataset_path: "./data/cub_subset"

# 3. è®­ç»ƒ
python src/scripts/train.py --config configs/train_config.yaml

# 4. ç”Ÿæˆå›¾åƒ
python src/scripts/inference.py \
    --checkpoint ./outputs/checkpoint-epoch-10 \
    --prompt "a bird with colorful feathers"
```

### ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†

```bash
# 1. å‡†å¤‡è‡ªå®šä¹‰æ•°æ®
python src/scripts/prepare_data.py \
    --type custom \
    --input ./my_data \
    --output ./data/custom_subset

# 2. ä¿®æ”¹é…ç½®
# ç¼–è¾‘ configs/train_config.yaml:
#   dataset_name: "custom"
#   dataset_path: "./data/custom_subset"

# 3. è®­ç»ƒå’Œæ¨ç†ï¼ˆåŒä¸Šï¼‰
```

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®ï¼ˆé€‚é… RTX 4090ï¼‰

å½“å‰é…ç½®å·²é’ˆå¯¹ RTX 4090 ä¼˜åŒ–ï¼š

```yaml
model:
  hidden_size: 768      # éšè—å±‚ç»´åº¦
  num_layers: 16        # Transformer å±‚æ•°
  num_heads: 12         # æ³¨æ„åŠ›å¤´æ•°

training:
  batch_size: 96        # æ‰¹æ¬¡å¤§å°ï¼ˆå……åˆ†åˆ©ç”¨ 24GB æ˜¾å­˜ï¼‰
  mixed_precision: "bf16"  # æ··åˆç²¾åº¦ï¼ˆBF16 æ›´ç¨³å®šï¼‰
  num_epochs: 1000      # è®­ç»ƒè½®æ•°
  save_every_n_epochs: 10  # æ¯ 10 ä¸ª epoch ä¿å­˜ä¸€æ¬¡
```

### å°æ˜¾å­˜é…ç½®

å¦‚æœæ˜¾å­˜ä¸è¶³ï¼Œå¯ä»¥å‡å°æ‰¹æ¬¡å¤§å°ï¼š

```yaml
training:
  batch_size: 32        # å‡å°æ‰¹æ¬¡å¤§å°
  gradient_accumulation_steps: 3  # ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯
```

## ğŸ” éªŒè¯å®‰è£…

è¿è¡ŒéªŒè¯è„šæœ¬æ£€æŸ¥ç¯å¢ƒï¼š

```bash
python verify_setup.py
```

åº”è¯¥çœ‹åˆ°ï¼š
- âœ… CUDA å¯ç”¨
- âœ… ä¾èµ–åŒ…å·²å®‰è£…
- âœ… GPU ä¿¡æ¯

## ğŸ“ ä¸‹ä¸€æ­¥

- ğŸ“– [02. å®‰è£…é…ç½®](./02-å®‰è£…é…ç½®.md) - è¯¦ç»†çš„ç¯å¢ƒé…ç½®è¯´æ˜
- ğŸ“– [03. æ•°æ®å‡†å¤‡](./03-æ•°æ®å‡†å¤‡.md) - æ·±å…¥äº†è§£æ•°æ®å‡†å¤‡
- ğŸ“– [05. è®­ç»ƒæŒ‡å—](./05-è®­ç»ƒæŒ‡å—.md) - å®Œæ•´çš„è®­ç»ƒæµç¨‹

## â“ é‡åˆ°é—®é¢˜ï¼Ÿ

- æŸ¥çœ‹ [08. æ•…éšœæ’é™¤](./08-æ•…éšœæ’é™¤.md)
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼š`./outputs/train.log`
- ç¡®è®¤ GPU æ˜¾å­˜æ˜¯å¦å……è¶³ï¼š`nvidia-smi`

---

**å¼€å§‹è®­ç»ƒ**: æŒ‰ç…§ä¸Šè¿°æ­¥éª¤è¿è¡Œç¬¬ä¸€ä¸ªè®­ç»ƒç¤ºä¾‹ï¼

