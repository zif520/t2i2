# æ•°æ®é›†é—®é¢˜ä¿®å¤

## ğŸ” é—®é¢˜å‘ç°

ç”¨æˆ·å‘ç°ç”Ÿæˆçš„å›¾åƒéƒ½æ˜¯ç°è‰²ï¼Œæ ¹æœ¬åŸå› æ˜¯**æ•°æ®é›†æœ¬èº«æ˜¯ç°è‰²çš„**ï¼

### é—®é¢˜æ ¹æº

1. **COCO æ•°æ®é›†åŠ è½½å¤±è´¥**: å½“ä» Hugging Face åŠ è½½ COCO æ•°æ®é›†å¤±è´¥æ—¶
2. **ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ**: ä»£ç ä¼šè°ƒç”¨ `_create_dummy_data()` åˆ›å»ºç¤ºä¾‹æ•°æ®
3. **ç°è‰²å›¾åƒ**: åŸæ¥çš„å®ç°åˆ›å»ºçš„æ˜¯çº¯ç°è‰²å›¾åƒ `RGB(128, 128, 128)`
4. **è®­ç»ƒç»“æœ**: æ¨¡å‹å­¦ä¹ åˆ°çš„éƒ½æ˜¯ç°è‰²å›¾åƒï¼Œæ‰€ä»¥ç”Ÿæˆä¹Ÿæ˜¯ç°è‰²

### ä»£ç ä½ç½®

`src/data/dataset.py` çš„ `_create_dummy_data()` æ–¹æ³•ï¼š

```python
# ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
image = Image.new("RGB", (self.image_size, self.image_size), color=(128, 128, 128))
# è¿™åˆ›å»ºçš„æ˜¯çº¯ç°è‰²å›¾åƒï¼
```

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤1: æ”¹è¿›ç¤ºä¾‹æ•°æ®ç”Ÿæˆ

å°†ç°è‰²å›¾åƒæ”¹ä¸ºå½©è‰²éšæœºå›¾åƒï¼š

```python
# ä¿®å¤å
import numpy as np
arr = np.random.randint(0, 255, (self.image_size, self.image_size, 3), dtype=np.uint8)
# æ·»åŠ åŸºç¡€é¢œè‰²ï¼Œç¡®ä¿æœ‰é¢œè‰²å·®å¼‚
r = np.random.randint(50, 200)
g = np.random.randint(50, 200)
b = np.random.randint(50, 200)
arr[:, :, 0] = (arr[:, :, 0] * 0.3 + r * 0.7).astype(np.uint8)
arr[:, :, 1] = (arr[:, :, 1] * 0.3 + g * 0.7).astype(np.uint8)
arr[:, :, 2] = (arr[:, :, 2] * 0.3 + b * 0.7).astype(np.uint8)
image = Image.fromarray(arr)
```

### ä¿®å¤2: ä¼˜å…ˆä½¿ç”¨æœ¬åœ°æ•°æ®é›†

å¦‚æœå­˜åœ¨æœ¬åœ°å‡†å¤‡å¥½çš„ `data/coco_subset/` ç›®å½•ï¼Œä¼˜å…ˆä½¿ç”¨ï¼š

```python
# é¦–å…ˆæ£€æŸ¥æœ¬åœ°æ•°æ®é›†
dataset_path = Path("./data/coco_subset")
metadata_file = dataset_path / "metadata.json"

if metadata_file.exists():
    # åŠ è½½æœ¬åœ°æ•°æ®é›†
    # ...
```

## ğŸ“Š å½±å“

### ä¿®å¤å‰
- æ•°æ®é›†: ç°è‰²å›¾åƒï¼ˆRGB=128,128,128ï¼‰
- è®­ç»ƒç»“æœ: æ¨¡å‹å­¦ä¹ ç”Ÿæˆç°è‰²å›¾åƒ
- ç”Ÿæˆå›¾åƒ: ç°è‰²ï¼Œæ²¡æœ‰å†…å®¹

### ä¿®å¤å
- æ•°æ®é›†: å½©è‰²éšæœºå›¾åƒï¼ˆæœ‰é¢œè‰²å·®å¼‚ï¼‰
- è®­ç»ƒç»“æœ: æ¨¡å‹å¯ä»¥å­¦ä¹ ç”Ÿæˆå½©è‰²å›¾åƒ
- ç”Ÿæˆå›¾åƒ: æœ‰é¢œè‰²ï¼Œæœ‰å†…å®¹

## ğŸ¯ ä¸‹ä¸€æ­¥

### é€‰é¡¹1: ä½¿ç”¨ä¿®å¤åçš„ä»£ç é‡æ–°è®­ç»ƒ

```bash
# é‡æ–°è®­ç»ƒï¼ˆä»å¤´å¼€å§‹ï¼‰
python src/scripts/train.py \
    --config configs/train_config.yaml
```

**æ³¨æ„**: å³ä½¿ä½¿ç”¨ä¿®å¤åçš„ç¤ºä¾‹æ•°æ®ï¼Œè´¨é‡ä»ç„¶æœ‰é™ã€‚å»ºè®®ä½¿ç”¨çœŸå®æ•°æ®ã€‚

### é€‰é¡¹2: ä½¿ç”¨çœŸå® COCO æ•°æ®é›†ï¼ˆæ¨èï¼‰

1. **å‡†å¤‡æœ¬åœ° COCO æ•°æ®**:
   ```bash
   python src/scripts/prepare_data.py \
       --type coco \
       --output ./data/coco_subset \
       --num_samples 50000
   ```

2. **ä¿®æ”¹é…ç½®**:
   ```yaml
   data:
     dataset_name: "coco"
     num_samples: 50000
   ```

3. **é‡æ–°è®­ç»ƒ**

### é€‰é¡¹3: ä½¿ç”¨å·²æœ‰çš„ coco_subset

å¦‚æœå·²ç»æœ‰ `data/coco_subset/` ç›®å½•ï¼š
- ä»£ç ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨
- ç¡®ä¿æœ‰ `metadata.json` å’Œ `images/` ç›®å½•

## âš ï¸ é‡è¦æç¤º

1. **éœ€è¦é‡æ–°è®­ç»ƒ**: ä¹‹å‰è®­ç»ƒçš„æ¨¡å‹æ˜¯åœ¨ç°è‰²æ•°æ®ä¸Šè®­ç»ƒçš„ï¼Œéœ€è¦é‡æ–°è®­ç»ƒ
2. **æ•°æ®è´¨é‡**: å³ä½¿ä¿®å¤äº†ç¤ºä¾‹æ•°æ®ï¼ŒçœŸå®æ•°æ®é›†ä»ç„¶æ›´å¥½
3. **æ£€æŸ¥æ•°æ®**: è®­ç»ƒå‰æ£€æŸ¥æ•°æ®é›†ï¼Œç¡®ä¿ä¸æ˜¯ç°è‰²

## ğŸ”§ éªŒè¯ä¿®å¤

```python
# æ£€æŸ¥æ•°æ®é›†
from src.data.dataset import TextImageDataset

dataset = TextImageDataset(
    dataset_name="coco",
    num_samples=5,
)

# æ£€æŸ¥æ ·æœ¬
for i in range(3):
    sample = dataset[i]
    img_tensor = sample['pixel_values']
    r, g, b = img_tensor[0], img_tensor[1], img_tensor[2]
    diff = (r - g).abs().mean() + (g - b).abs().mean()
    print(f"æ ·æœ¬ {i}: é€šé“å·®å¼‚ = {diff:.4f}")
    # åº”è¯¥ > 0.1ï¼ˆæœ‰é¢œè‰²ï¼‰
```

---

**ä¿®å¤çŠ¶æ€**: âœ… å·²ä¿®å¤  
**æ–‡ä»¶**: `src/data/dataset.py`  
**æ—¥æœŸ**: 2026-01-13

